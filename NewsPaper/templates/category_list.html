{% extends 'flatpages/default.html' %}


{% load custom_filters %}


{% block title %}
News
{% endblock title %}


{% block content %}
<h1 style="text-align: center; margin-bottom: 20px;">‚óÑ –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚ñ∫</h1>
<h6 style="text-align: center; color: #555;"><i>–í—ã –≤–∏–¥–∏—Ç–µ {{ category_news|length }} –∏–∑ {{ paginator.count }} –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "{{ category.name_category }}"</i></h6>

<hr style="margin: 20px 0;">

{% if request.user.is_authenticated %}
    <div style="text-align: center; margin-bottom: 20px;">
        {% if is_not_subscriber %}
            <a href="{% url 'subscribe' category.id %}" class="btn btn-success btn-sm">üì© –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</a>
        {% else %}
            <a href="{% url 'delete_subscribe' category.id %}" class="btn btn-danger btn-sm">üö´ –û—Ç–ø–∏—Å–∞—Ç—å—Å—è</a>
        {% endif %}
    </div>
{% endif %}

<form method="GET">
    {{ filterset.form.as_p }}
    <button type="submit" class="btn btn-primary">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
</form>

<br>

{% if category_news %}
<table border="1" cellpadding="10" cellspacing="0" width="100%" style="border-collapse: collapse; text-align: center;">
    <thead style="background-color: #f0f0f0; font-weight: bold;">
        <tr>
            <th>–¢–∏–ø</th>
            <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
            <th>–î–∞—Ç–∞</th>
            <th>–¢–µ–∫—Å—Ç</th>
            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</th>
        </tr>
    </thead>
    <tbody>
        {% for new in category_news %}
        <tr>
            <td>{{ new.get_publication_display }}</td>
            <td><a href="{% url 'new_detail' new.id %}" style="text-decoration: none; color: #007bff;">{{ new.title }}</a></td>
            <td>{{ new.date_creation|date:'d M Y' }}</td>
            <td style="text-align: left;">{{ new.text|truncatewords:20|censor }}</td>
            <td>
                {% for cat in new.post_category.all %}
                    <a href="{% url 'category_news' cat.id %}" style="text-decoration: none;">{{ cat }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div style="text-align: center; padding: 20px; border: 1px solid #ccc; background-color: #f9f9f9;">
    <h2>–ù–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ üòî</h2>
</div>
{% endif %}


<hr>

{# –î–æ–±–∞–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É #}

   {# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö #}
   {% if page_obj.has_previous %}
       <a href="?page=1">1</a>
       {% if page_obj.previous_page_number != 1 %}
           ...
           <a href="?page={{ page_obj.previous_page_number }}">{{ page_obj.previous_page_number }}</a>
       {% endif %}
   {% endif %}

   {# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ #}
   {{ page_obj.number }}

   {# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö #}
   {% if page_obj.has_next %}
       <a href="?page={{ page_obj.next_page_number }}">{{ page_obj.next_page_number }}</a>
       {% if paginator.num_pages != page_obj.next_page_number %}
           ...
           <a href="?page={{ page_obj.paginator.num_pages }}">{{ page_obj.paginator.num_pages }}</a>
       {% endif %}
   {% endif %}

<hr>
<a href="{% url 'news_list' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>

{% endblock content %}